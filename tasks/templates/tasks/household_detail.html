{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h3>{{ house.name }}</h3>
    <div class="text-muted">Подарок месяца: <b>{{ house.gift }}</b></div>
  </div>
  <div>
    <a href="{% url 'tasks:household_stats' house.id %}" class="btn btn-outline-secondary">Статистика</a>
  </div>
</div>

<div class="row g-4">
  <div class="col-md-6">
    <h5>Задачи</h5>
    <div class="mb-3">
        <a class="btn btn-outline-primary btn-sm" href="{% url 'tasks:invite_by_username' house.id %}">Пригласить по логину</a>
        <a class="btn btn-outline-success btn-sm" href="{% url 'tasks:invite_generate_code' house.id %}">Создать ссылку-приглашение</a>
        <a class="btn btn-outline-secondary btn-sm" href="{% url 'tasks:invitations_inbox' %}">Входящие приглашения</a>
    </div>
    <ul class="list-group">
      {% for t in tasks %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <b>{{ t.title }}</b>
            {% if t.assigned_to %}<span class="text-muted"> • {{ t.assigned_to.username }}</span>{% endif %}
            <div class="small">{{ t.description }}</div>
            <span class="badge bg-info mt-1">{{ t.points }} балл(ов)</span>
            {% if t.is_completed %}
              <span class="badge bg-success mt-1">Выполнил: {{ t.completed_by.username }}</span>
            {% endif %}
          </div>
          <a class="btn btn-sm {% if t.is_completed %}btn-warning{% else %}btn-success{% endif %}"
             href="{% url 'tasks:task_toggle_done' t.id %}">
            {% if t.is_completed %}Отменить{% else %}Готово{% endif %}
          </a>
        </li>
      {% empty %}
        <li class="list-group-item">Задач пока нет.</li>
      {% endfor %}
    </ul>
  </div>

  <div class="col-md-6">
    <h5>Добавить задачу</h5>
    <form method="post" action="{% url 'tasks:task_create' house.id %}">
      {% csrf_token %}
      {{ task_form.as_p }}
      <button class="btn btn-primary">Добавить</button>
    </form>
  </div>
</div>
{% endblock %}
{% block extra_footer %}
  {% include "footer.html" %}
{% endblock %}